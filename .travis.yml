sudo: require
language: cpp
#compiler: clang

before_install:
  - sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test
  - sudo apt-get update -qq
  - sudo pip install codecov
  - wget -O cmake.sh https://cmake.org/files/v3.11/cmake-3.11.3-Linux-x86_64.sh
  - sudo sh cmake.sh --skip-license --exclude-subdir --prefix=/usr/local

install:
  - sudo apt-get install -qq g++-5
    # Codecov
  - sudo update-alternatives --install /usr/bin/gcov gcov /usr/bin/gcov-5 90

script:
  - mkdir build && cd build
  - cmake -version
  - cmake -DCMAKE_BUILD_TYPE=DEBUG -DSudokuSuite_SANITIZER_ADDRESS=ON -DSudokuSuite_SANITIZER_UB=ON -DSudokuSuite_TESTS=ON .. -DSudokuSuite_GCOV=ON
  - cd tests
  - ./testing
  - gcov-5 -n -o . testing > /dev/null;
  - codecov

after_success:
  - bash <(curl -s https://codecov.io/bash)
