sudo: require
language: cpp
#compiler: clang

addons:
  apt:
    sources:
     - ubuntu-toolchain-r-test
       #- llvm-toolchain-trusty
    packages:
     - ninja-build
       #- clang

before_install:
  - sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test
  - sudo apt-get update -qq
  - sudo pip install codecov
  - wget -O cmake.sh https://cmake.org/files/v3.11/cmake-3.11.3-Linux-x86_64.sh
  - sudo sh cmake.sh --skip-license --exclude-subdir --prefix=/usr/local
  - echo $PATH 

install:
  - sudo apt-get install -qq g++-5
    # Codecov
  - sudo update-alternatives --install /usr/bin/gcov gcov /usr/bin/gcov-5 90

script:
  - mkdir build && cd build
  - cmake -version
  - /usr/local/bin/cmake -GNinja -DCMAKE_CXX_COMPILER=g++-5 -DCMAKE_BUILD_TYPE=DEBUG -DSudokuSuite_TESTS=ON -DSudokuSuite_GCOV=ON "-DCMAKE_CXX_FLAGS=-std=c++1z" ..
  - ninja -v
  - cd tests
  - ./testing
  - gcov-5 -n -o . testing > /dev/null;
  - codecov

after_success:
  - bash <(curl -s https://codecov.io/bash)
